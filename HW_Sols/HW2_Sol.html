<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>hw2_sol</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="HW2_Sol_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW2_Sol_files/libs/quarto-html/quarto.js"></script>
<script src="HW2_Sol_files/libs/quarto-html/popper.min.js"></script>
<script src="HW2_Sol_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW2_Sol_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW2_Sol_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW2_Sol_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW2_Sol_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW2_Sol_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW2_Sol_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="homework-2-solutions" class="level1">
<h1>Homework 2 Solutions</h1>
<p><em>Check Due Date and Office Hours on Canvas</em></p>
<p><a href="https://www.stat.purdue.edu/~qfsong/teaching/511/probability_and_statistics_for_engineering_and_the_sciences.pdf">Textbook is here.</a></p>
<ol type="1">
<li><ul>
<li><strong>Law 1</strong>: The blue colored region is the final for LHS and RHS <img src="./Figures/DM_Law1.svg" id="fig-math" class="img-fluid" style="width:40.0%" alt="DeMorgan’s Law1"></li>
<li><strong>Law 2</strong>: All blue colored region except the shaded part is the final for LHS and RHS <img src="./Figures/DM_Law2.svg" id="fig-math" class="img-fluid" style="width:40.0%" alt="DeMorgan’s Law2">
</li>
</ul></li>
<li><p>(Events) Textbook Section 2.1 #1 (Textbook notation for sample notation is <span class="math inline">\(\mathcal{S}\)</span>)</p>
<ol type="a">
<li><p><span class="math inline">\(\Omega = \{1324,3124,1342,3142,2314,3214,2341,3241, 1423,4123,1432,4132,2413,4213,2431,4231\}\)</span></p></li>
<li><p><span class="math inline">\(A = \{1324, 1342, 1423, 1432\}\)</span></p></li>
<li><p><span class="math inline">\(B = \{2314, 2341, 2413, 2431, 3214, 3241,4213,4231 \}\)</span></p></li>
<li><p><span class="math inline">\(A \cup B = \{1324, 1342, 1423, 1432, 2314, 2341, 2413, 2431, 3214, 3241,4213,4231 \}\)</span></p></li>
</ol>
<p><span class="math inline">\(A \cap B = \{ \}\)</span> (Null set because either 1 or 2, not both, can get into the championship)</p>
<p><span class="math inline">\(A' = \{3124,3142,2314,3214,2341,3241,4123,4132,2413,4213,2431,4231\}\)</span></p></li>
<li><p>(Events) Textbook Section 2.1 #3 Though not asked, it is a good idea to first write down all possible outcomes (aka Sample Space)</p>
<p><span class="math inline">\(\Omega = \{SSS,SSF,SFS,FSS, SFF, FSF, FFS, FFF\}\)</span> (<span class="math inline">\(2^3\)</span> possible outcomes)</p>
<ol type="a">
<li><p><span class="math inline">\(A = \{SSF,SFS,FSS\}\)</span></p></li>
<li><p><span class="math inline">\(B = \{SSS,SSF,SFS,FSS \}\)</span></p></li>
<li><p><span class="math inline">\(C = \{SSS,SSF,SFS\}\)</span></p></li>
<li><p><span class="math inline">\(C' = \{FSS, SFF, FSF, FFS, FFF\}\)</span></p></li>
</ol>
<p><span class="math inline">\(A \cup C = \{SSF,SFS,FSS, SFF, FSF, FFS, FFF\}\)</span></p>
<p><span class="math inline">\(A \cap C = \{FSS\}\)</span></p>
<p><span class="math inline">\(B \cup C = \{SSS,SSF,SFS,FSS, SFF, FSF, FFS, FFF\}\)</span></p>
<p><span class="math inline">\(B \cap C = \{FSS\}\)</span></p></li>
<li><p>(Events, Independence, Disjointness) Textbook Section 2.2 #17</p>
<ol type="a">
<li><p>There is a possibility (an outcome in Sample Space) that the next request is neither SPSS or SAS.</p></li>
<li><p><span class="math inline">\(P(A') = 1 - 0.3 = 0.7\)</span></p></li>
<li><p><span class="math inline">\(P(A \cup B) =  P(A) + P(B) - P(A \cap B) = 0.3 + 0.5 - 0 = 0.8\)</span> (<span class="math inline">\(P(A \cap B) = 0\)</span> assumed because the request cannot be involving SPSS and SAS at the same time, also otherwise we cannot calculate the values)</p></li>
<li><p>Use DeMorgan’s Laws (and first axiom of probability) <span class="math inline">\(P(A' \cap B') = P((A \cup B)') = 1 - P(A\cup B) = 0.2\)</span></p></li>
</ol></li>
<li><p>(Probability) Textbook Section 2.2 #23</p>
<p>15 (<span class="math inline">\(=\)</span> <span class="math inline">\(^6C_2\)</span>) equally likely outcomes</p>
<ol type="a">
<li><p><span class="math inline">\(\frac{^2C_2}{^6C_2}\)</span></p></li>
<li><p><span class="math inline">\(\frac{^4C_2}{^6C_2}\)</span></p></li>
<li><p><span class="math inline">\(\frac{^4C_2 + 4}{^6C_2}\)</span></p></li>
<li><p><span class="math inline">\(\frac{4\times2}{^6C_2}\)</span></p></li>
</ol></li>
<li><p>(Probability/Counting) Textbook Section 2.3 #40</p>
<ol type="a">
<li><p><span class="math inline">\(\frac{12!}{3^4}\)</span></p></li>
<li><p>(Assuming all outcomes are equally likely) <span class="math inline">\(\frac{4!}{\frac{12!}{3^4}}\)</span></p></li>
</ol></li>
<li><p>We have a deck of randomly shuffled typical playing cards (if you do not know about cards, please check online).</p>
<ul>
<li>If we choose one card at random,
<ul>
<li><span class="math inline">\(\Omega =\)</span> All single cards. <span class="math inline">\(n(\Omega) = 52\)</span></li>
<li><span class="math inline">\(\frac{26}{52}\)</span></li>
</ul></li>
<li>If we choose two cards together randomly,
<ul>
<li><span class="math inline">\(\Omega =\)</span> All combinations of different cards. <span class="math inline">\(n(\Omega) =\)</span> <span class="math inline">\(52 \choose 2\)</span></li>
<li><span class="math inline">\(\frac{26 \choose 2}{52 \choose 2}\)</span></li>
<li><span class="math inline">\(\frac{26 \choose 1 }{52 \choose 2} \times \frac{26 \choose 1 }{52 \choose 2}\)</span></li>
</ul></li>
<li>If we choose two cards one-after-another after replacing the card
<ul>
<li><span class="math inline">\(\Omega =\)</span> All combinations including choosing the same card twice, <span class="math inline">\(n(\Omega) =\)</span> <span class="math inline">\(52 \times 52\)</span></li>
<li><span class="math inline">\(\frac{26 \times 26}{52 \times 52}\)</span></li>
<li><span class="math inline">\(\frac{26 \times 26}{52 \times 52}\)</span></li>
</ul></li>
</ul></li>
<li><p>(A classical problem) <em>You need to apply Bayes’ Theorem</em> Let <span class="math inline">\(A\)</span> denote the event that I have COVID-19 <span class="math inline">\(\implies\)</span> <span class="math inline">\(A'\)</span> is the event that I do not have COVID-19. <span class="math inline">\(A\)</span> and <span class="math inline">\(A'\)</span> form mutually exlusive and exhaustive events such that <span class="math inline">\(P(A) + P(A') = 1\)</span>. Let <span class="math inline">\(B\)</span> denote the event that I tested positive. We need to find <span class="math inline">\(P(A|B)\)</span></p></li>
</ol>
<p><span class="math display">\[P(A|B) = \frac{P(B|A)P(A)}{P(B|A)P(A) + P(B|A')P(A')}\]</span></p>
<p><span class="math display">\[P(A) = 0.1 \implies P(A') = 0.9\]</span></p>
<p><span class="math display">\[P(B|A) = 0.99, P(B|A') = 0.02\]</span></p>
<p><span class="math inline">\(\implies P(A|B) = \frac{0.99 \times 0.1 }{0.99 \times 0.1 + 0.02 \times 0.9} = 84.6\%\)</span> <em>(surprising?)</em></p>
<ol start="9" type="1">
<li>Textbook Section 2.4 #60 (Another application of Bayes’ Theorem) We are only talking about light aircraft, so you do not need to be thinking about other aircrafts (for example, you do not need to worry about <span class="math inline">\(P(Discovered|NotLightAircraft)\)</span>)</li>
</ol>
<p>Given light aircraft, <span class="math inline">\(P(Discovered) = 0.7\)</span> <span class="math inline">\(P(YesLocator|Discovered) = 0.6\)</span> <span class="math inline">\(P(NoLocator|NotDiscovered) = 0.9\)</span></p>
<ol type="a">
<li><span class="math display">\[P(NotDiscovered|YesLocator) = \frac{P(YesLocator|NotDiscovered)P(NotDiscovered)}{P(YesLocator|NotDiscovered)P(NotDiscovered) + P(YesLocator|Discovered)P(Discovered)}\]</span></li>
</ol>
<ul>
<li><span class="math inline">\(P(YesLocator|NotDiscovered) = 1 - 0.9 = 0.1\)</span></li>
<li><span class="math inline">\(P(NotDiscovered) = 1 - 0.7 = 0.3\)</span></li>
</ul>
<p><span class="math display">\[P(NotDiscovered|YesLocator) = \frac{0.1\times 0.3}{0.1\times 0.3 + 0.6 \times 0.7} = \frac{3}{45} = \frac{1}{15}\]</span></p>
<ol start="10" type="1">
<li><img src="./Figures/Venn_ABC.svg" id="fig-math" class="img-fluid" style="width:40.0%" alt="3 events generic Venn Diagram"> <span class="math inline">\(P(A \cup B \cup C) = P(A) + P(B) + P(C) - P(A \cap B) - P(B \cap C) - P(C \cap A) + P(A \cap B \cap C)\)</span></li>
</ol>
<ul>
<li><p><span class="math inline">\(P(A) = 0.75\)</span></p></li>
<li><p><span class="math inline">\(P(B|A) = \frac{P(A \cap B)}{P(A)}  = 0.9 \implies P(A \cap B) = 0.9 \times 0.75 = 0.675\)</span></p></li>
<li><p><span class="math inline">\(P(B|A') = \frac{P(A' \cap B)}{P(A')} = 0.8 \implies P(A' \cap B) = 0.8 \times (1-0.75) = 0.2\)</span></p></li>
<li><p><span class="math inline">\(P(B) = P(A \cap B) + P(A' \cap B) = 0.875\)</span></p></li>
<li><p><span class="math inline">\(P(C|A \cap B) = \frac{P(A \cap B \cap C)}{P(A \cap B)} = 0.8 \implies P(A \cap B \cap C) = 0.8 \times 0.675 = 0.54\)</span> <em>(Answer (b))</em></p></li>
<li><p><span class="math inline">\(P(C|A \cap B') = \frac{P(A \cap B' \cap C)}{P(A \cap B')} = 0.6\)</span></p>
<ul>
<li><span class="math inline">\(P(A) = P(A \cap B) + P(A \cap B') \implies P(A \cap B') = 0.75 - 0.675 = 0.075\)</span></li>
<li><span class="math inline">\(\implies P(A \cap B' \cap C) = 0.6 \times 0.075 = 0.045\)</span></li>
</ul></li>
<li><p><span class="math inline">\(P(C|A' \cap B) = \frac{P(A' \cap B \cap C)}{P(A' \cap B)} = 0.6 \implies P(A' \cap B \cap C) = 0.6 \times 0.2 = 0.12\)</span></p>
<ul>
<li><span class="math inline">\(\implies P(B \cap C) = P(A' \cap B \cap C) + P(A \cap B \cap C) = 0.12 + 0.54 = 0.66\)</span> <em>(Answer (c))</em></li>
</ul></li>
<li><p><span class="math inline">\(P(C|A' \cap B') = \frac{P(A' \cap B'  \cap C)}{P(A' \cap B')} = 0.3\)</span></p>
<ul>
<li><span class="math inline">\(P(A'\cap B') = P((A \cup B)') = 1- P(A \cup B) = 1 - P(A) - P(B) +P(A \cap B) = 1 - 0.75 - 0.875 + 0.675 = 0.05\)</span></li>
<li><span class="math inline">\(\implies P(A' \cap B' \cap C) = 0.3 \times 0.05 = 0.015\)</span></li>
<li><span class="math inline">\(P(C) =  P(A' \cap B' \cap C) + P(A \cap B' \cap C) + P(A' \cap B \cap C) + P(A \cap B \cap C) = 0.015 + (0.66-0.54) + 0.045 +0.54 = 0.72\)</span> <em>(Answer (d))</em></li>
</ul></li>
<li><p><em>(Answer (e))</em> <span class="math inline">\(P(A|B \cap C) = \frac{P(A \cap B \cap C)}{P(B \cap C)} = \frac{0.54}{0.66} = 0.81\)</span></p></li>
</ul>
<ol start="11" type="1">
<li><span class="math inline">\(P(componentworks) = 0.9\)</span> All components are independent. Lower branch works only if both <span class="math inline">\(C_3\)</span> and <span class="math inline">\(C_4\)</span> (<span class="math inline">\(\cap\)</span>) work. Upper branch works if either <span class="math inline">\(C_1\)</span> or <span class="math inline">\(C_2\)</span> works (<span class="math inline">\(\cup\)</span>). System works if either upper branch or lower branch works (also if both works).</li>
</ol>
<ul>
<li><span class="math inline">\(P(C_3 \cap C_4) = 0.9 \times 0.9 = 0.81\)</span></li>
</ul>
<p><span class="math inline">\(P(C_1 \cup C_2) = P(C_1) + P(C_2) - P(C_1 \cap C_2)  = 1.8 - 0.81 = 0.99\)</span></p>
<p><span class="math inline">\(P(system) = P((C_1 \cup C_2) \cup (C_3 \cap C_4)) = P(C_1 \cup C_2) + P(C_3 \cap C_4) - P((C_1 \cup C_2) \cap (C_3 \cap C_4))\)</span> <span class="math inline">\(\implies P(system) = 0.99 +0.81 - (0.99 \times 0.81) = 0.9981\)</span></p>
<ul>
<li>Note that our defintion of events <span class="math inline">\(C_1, C_2, C_3, C_4\)</span> and the ‘system’ must be subsets of sample space.
<ul>
<li>One way to define Sample Space <span class="math inline">\(\Omega = \{0000,0001,0011,..., \}\)</span> with <span class="math inline">\(2^4 = 16\)</span> possible outcomes. Where <span class="math inline">\(0000\)</span> indicates all components are not working, <span class="math inline">\(0001\)</span> indicates fourth component is working, <span class="math inline">\(0001\)</span> indicates third and fourth components are working, and so on. Possible outcomes when system will work are <span class="math inline">\(\{0111,1011\}\)</span>. Note that the outcomes are <strong>not</strong> “equally likely”.</li>
<li>Venn diagram will have four events. Only some outcomes are marked. The probability values are not marked. <img src="./Figures/Venn_HW2_Prob11.svg" id="fig-math" class="img-fluid" style="width:40.0%" alt="Venn Diagram for Section 2.5 Textbook Problem 80"></li>
</ul></li>
</ul>
<ol start="12" type="1">
<li>Car manufacturing can be considered an assembly of 500 independent components. If 99.9% of cars needs to be defect-free,
<ul>
<li>If <span class="math inline">\(p\)</span> is the required probability <span class="math inline">\((1-p)^{500} = 0.999 \implies (1-p) \approx 0.999998 \implies p = 0.000002 = 2 ppm\)</span></li>
<li>Similar to the provious problem each outcome will have 500 ’0’s and ’1’s. <span class="math inline">\(\Omega = \{\underbrace{0000...000}_{500 components},\underbrace{0000...001}_{500 components},...,\underbrace{111...111}_{500 components} \}\)</span> making a total of <span class="math inline">\(2^{500}\)</span> possible outcomes. You can imagine a Venn diagram with 500 circles.</li>
</ul></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>